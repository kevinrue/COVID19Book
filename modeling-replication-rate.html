<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Modeling Replication rate | Understanding the COVID-19 pandemic</title>
  <meta name="description" content="5 Modeling Replication rate | Understanding the COVID-19 pandemic" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Modeling Replication rate | Understanding the COVID-19 pandemic" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://seandavi.github.io/COVID19Book" />
  <meta property="og:image" content="https://seandavi.github.io/COVID19Bookimages/logo.png" />
  
  <meta name="github-repo" content="seandavi/COVID19Book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Modeling Replication rate | Understanding the COVID-19 pandemic" />
  
  
  <meta name="twitter:image" content="https://seandavi.github.io/COVID19Bookimages/logo.png" />

<meta name="author" content="Vincent Carey" />
<meta name="author" content="Charles Morefield" />
<meta name="author" content="John Mallery" />
<meta name="author" content="Sean Davis" />


<meta name="date" content="2020-04-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="use-cases.html"/>
<link rel="next" href="european-datasets.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.13/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/dt-ext-scroller-1.10.20/css/scroller.dataTables.min.css" rel="stylesheet" />
<script src="libs/dt-ext-scroller-1.10.20/js/dataTables.scroller.min.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="part"><span><b>I Introduction</b></span></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Motivation</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#origins-of-this-package"><i class="fa fa-check"></i><b>1.1</b> Origins of this package</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="quick-start.html"><a href="quick-start.html"><i class="fa fa-check"></i><b>2</b> Quick start</a><ul>
<li class="chapter" data-level="2.1" data-path="quick-start.html"><a href="quick-start.html#installation"><i class="fa fa-check"></i><b>2.1</b> Installation</a></li>
<li class="chapter" data-level="2.2" data-path="quick-start.html"><a href="quick-start.html#covid-19-resources-in-this-package"><i class="fa fa-check"></i><b>2.2</b> COVID-19 resources in this package</a><ul>
<li class="chapter" data-level="2.2.1" data-path="quick-start.html"><a href="quick-start.html#epidemic-time-series-data"><i class="fa fa-check"></i><b>2.2.1</b> Epidemic time-series data</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="quick-start.html"><a href="quick-start.html#additional-resources-described-in-this-vignette"><i class="fa fa-check"></i><b>2.3</b> Additional resources described in this vignette</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="epidemic-time-series-data-1.html"><a href="epidemic-time-series-data-1.html"><i class="fa fa-check"></i><b>3</b> Epidemic time series data</a><ul>
<li class="chapter" data-level="3.1" data-path="epidemic-time-series-data-1.html"><a href="epidemic-time-series-data-1.html#access-data"><i class="fa fa-check"></i><b>3.1</b> Access data</a><ul>
<li class="chapter" data-level="3.1.1" data-path="epidemic-time-series-data-1.html"><a href="epidemic-time-series-data-1.html#jhu-dataset"><i class="fa fa-check"></i><b>3.1.1</b> JHU Dataset</a></li>
<li class="chapter" data-level="3.1.2" data-path="epidemic-time-series-data-1.html"><a href="epidemic-time-series-data-1.html#usafacts-dataset"><i class="fa fa-check"></i><b>3.1.2</b> USAFacts Dataset</a></li>
<li class="chapter" data-level="3.1.3" data-path="epidemic-time-series-data-1.html"><a href="epidemic-time-series-data-1.html#nytimes-datasets"><i class="fa fa-check"></i><b>3.1.3</b> NYTimes datasets</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="use-cases.html"><a href="use-cases.html"><i class="fa fa-check"></i><b>4</b> Use cases</a><ul>
<li class="chapter" data-level="4.1" data-path="use-cases.html"><a href="use-cases.html#basic-data-exploration"><i class="fa fa-check"></i><b>4.1</b> Basic data exploration</a></li>
<li class="chapter" data-level="4.2" data-path="use-cases.html"><a href="use-cases.html#visualize-time-series-data"><i class="fa fa-check"></i><b>4.2</b> Visualize time series data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="modeling-replication-rate.html"><a href="modeling-replication-rate.html"><i class="fa fa-check"></i><b>5</b> Modeling Replication rate</a><ul>
<li class="chapter" data-level="5.1" data-path="modeling-replication-rate.html"><a href="modeling-replication-rate.html#background"><i class="fa fa-check"></i><b>5.1</b> Background</a><ul>
<li class="chapter" data-level="5.1.1" data-path="modeling-replication-rate.html"><a href="modeling-replication-rate.html#what-is-r_0"><i class="fa fa-check"></i><b>5.1.1</b> What is <span class="math inline">\(R_0\)</span>?</a></li>
<li class="chapter" data-level="5.1.2" data-path="modeling-replication-rate.html"><a href="modeling-replication-rate.html#what-do-r_0-values-mean"><i class="fa fa-check"></i><b>5.1.2</b> What do <span class="math inline">\(R_0\)</span> values mean?</a></li>
<li class="chapter" data-level="5.1.3" data-path="modeling-replication-rate.html"><a href="modeling-replication-rate.html#how-is-the-r_0-of-a-disease-calculated"><i class="fa fa-check"></i><b>5.1.3</b> How is the <span class="math inline">\(R_0\)</span> of a disease calculated?</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="modeling-replication-rate.html"><a href="modeling-replication-rate.html#simulated-epidemic-model"><i class="fa fa-check"></i><b>5.2</b> Simulated epidemic model</a></li>
<li class="chapter" data-level="5.3" data-path="modeling-replication-rate.html"><a href="modeling-replication-rate.html#real-data-examples"><i class="fa fa-check"></i><b>5.3</b> Real data examples</a><ul>
<li class="chapter" data-level="5.3.1" data-path="modeling-replication-rate.html"><a href="modeling-replication-rate.html#hubei-province"><i class="fa fa-check"></i><b>5.3.1</b> Hubei Province</a></li>
<li class="chapter" data-level="5.3.2" data-path="modeling-replication-rate.html"><a href="modeling-replication-rate.html#italy"><i class="fa fa-check"></i><b>5.3.2</b> Italy</a></li>
<li class="chapter" data-level="5.3.3" data-path="modeling-replication-rate.html"><a href="modeling-replication-rate.html#new-york-city"><i class="fa fa-check"></i><b>5.3.3</b> New York City</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="european-datasets.html"><a href="european-datasets.html"><i class="fa fa-check"></i><b>6</b> European datasets</a></li>
<li class="chapter" data-level="7" data-path="epicurves.html"><a href="epicurves.html"><i class="fa fa-check"></i><b>7</b> Epicurves</a><ul>
<li class="chapter" data-level="7.1" data-path="epicurves.html"><a href="epicurves.html#worldwide-datasets"><i class="fa fa-check"></i><b>7.1</b> Worldwide datasets</a></li>
<li class="chapter" data-level="7.2" data-path="epicurves.html"><a href="epicurves.html#european-datasets-1"><i class="fa fa-check"></i><b>7.2</b> European datasets</a></li>
<li class="chapter" data-level="7.3" data-path="epicurves.html"><a href="epicurves.html#united-states-datasets"><i class="fa fa-check"></i><b>7.3</b> United States datasets</a><ul>
<li class="chapter" data-level="7.3.1" data-path="epicurves.html"><a href="epicurves.html#usafacts"><i class="fa fa-check"></i><b>7.3.1</b> USAFacts</a></li>
<li class="chapter" data-level="7.3.2" data-path="epicurves.html"><a href="epicurves.html#new-york-times"><i class="fa fa-check"></i><b>7.3.2</b> New York Times</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="map-visualizations.html"><a href="map-visualizations.html"><i class="fa fa-check"></i><b>8</b> Map visualizations</a><ul>
<li class="chapter" data-level="8.1" data-path="map-visualizations.html"><a href="map-visualizations.html#interactive-maps"><i class="fa fa-check"></i><b>8.1</b> Interactive maps</a></li>
<li class="chapter" data-level="8.2" data-path="map-visualizations.html"><a href="map-visualizations.html#united-states"><i class="fa fa-check"></i><b>8.2</b> United States</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Understanding the COVID-19 pandemic</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modeling-replication-rate" class="section level1">
<h1><span class="header-section-number">5</span> Modeling Replication rate</h1>
<div id="background" class="section level2">
<h2><span class="header-section-number">5.1</span> Background</h2>
<p>TODO: PARAPHRASE!!!!!</p>
<div id="what-is-r_0" class="section level3">
<h3><span class="header-section-number">5.1.1</span> What is <span class="math inline">\(R_0\)</span>?</h3>
<p><span class="math inline">\(R_0\)</span> is pronounced “R naught.” It’s a mathematical term that indicates how contagious an infectious disease is. It’s also referred to as the reproduction number. As an infection spreads to new people, it reproduces itself.</p>
<p><span class="math inline">\(R_0\)</span> tells you the average number of people who will catch a disease from one contagious person. It specifically applies to a population of people who were previously free of infection and haven’t been vaccinated. If a disease has an <span class="math inline">\(R_0\)</span> of 18, a person who has the disease will transmit it to an average of 18 other people, as long as no one has been vaccinated against it or is already immune to it in their community.</p>
</div>
<div id="what-do-r_0-values-mean" class="section level3">
<h3><span class="header-section-number">5.1.2</span> What do <span class="math inline">\(R_0\)</span> values mean?</h3>
<p>Three possibilities exist for the potential spread or decline of a disease, depending on its <span class="math inline">\(R_0\)</span> value:</p>
<ul>
<li>If <span class="math inline">\(R_0\)</span> is less than 1, each existing infection causes less than one new infection. In this case, the disease will decline and eventually die out.</li>
<li>If <span class="math inline">\(R_0\)</span> equals 1, each existing infection causes one new infection. The disease will stay alive and stable, but there won’t be an outbreak or an epidemic.</li>
<li>If <span class="math inline">\(R_0\)</span> is more than 1, each existing infection causes more than one new infection. The disease will spread between people, and there may be an outbreak or epidemic.</li>
</ul>
<p>Importantly, a disease’s <span class="math inline">\(R_0\)</span> value only applies when everyone in a population is completely vulnerable to the disease. This means:</p>
<ul>
<li>no one has been vaccinated</li>
<li>no one has had the disease before</li>
<li>there’s no way to control the spread of the disease</li>
</ul>
<p>This combination of conditions is rare nowadays thanks to advances in medicine. Many diseases that were deadly in the past can now be contained and sometimes cured. For example, in 1918 there was a worldwide outbreak of the swine flu that killed 50 million people. According to a review article published in BMC Medicine, the <span class="math inline">\(R_0\)</span> value of the 1918 pandemic was estimated to be between 1.4 and 2.8. But when the swine flu, or H1N1 virus, came back in 2009, its <span class="math inline">\(R_0\)</span> value was between 1.4 and 1.6, report researchers in the journal Science. The existence of vaccines and antiviral drugs made the 2009 outbreak much less deadly.</p>
</div>
<div id="how-is-the-r_0-of-a-disease-calculated" class="section level3">
<h3><span class="header-section-number">5.1.3</span> How is the <span class="math inline">\(R_0\)</span> of a disease calculated?</h3>
<p>The following factors are taken into account to calculate the <span class="math inline">\(R_0\)</span> of a disease:</p>
<ul>
<li><p><em>Infectious period</em>: Some diseases are contagious for longer periods than others. For example, according to the Centers for Disease Control and Prevention, adults with the flu are typically contagious for up to eight days, while children can be contagious for up to two weeks. The longer the infectious period of a disease, the more likely an infected person is to spread the disease to other people. A long period of infectiousness will contribute to a higher <span class="math inline">\(R_0\)</span> value.</p></li>
<li><p><em>Contact rate</em>: If a person who’s infected with a contagious disease comes into contact with many people who aren’t infected or vaccinated, the disease will spread more quickly. If that person remains at home, in a hospital, or otherwise quarantined while they’re contagious, the disease will spread more slowly. A high contact rate will contribute to a higher <span class="math inline">\(R_0\)</span> value.</p></li>
<li><p><em>Mode of transmission</em>:
The diseases that spread most quickly and easily are the ones that can travel through the air, such as the flu or measles. Physical contact with an infected person isn’t necessary for the transmission of such conditions. You can catch the flu from breathing near someone who has the flu, even if you never touch them.</p></li>
</ul>
<p>In contrast, diseases that are transmitted through bodily fluids, such as Ebola or HIV, aren’t as easy to catch or spread. This is because you need to come into contact with infected blood, saliva, or other bodily fluids to contract them. Airborne illnesses tend to have a higher <span class="math inline">\(R_0\)</span> value than those spread through contact.</p>
</div>
</div>
<div id="simulated-epidemic-model" class="section level2">
<h2><span class="header-section-number">5.2</span> Simulated epidemic model</h2>
<p>Following code conveyed by John Mallery, we have the following
approach for estimating <span class="math inline">\(R_0\)</span> using a single realization of
an epidemic simulation.</p>
<p>Note that there can be failures of <code>estimate.R</code> for certain
inputs. We are working on that.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1"><span class="kw">library</span>(R0)</a>
<a class="sourceLine" id="cb49-2" data-line-number="2"><span class="kw">library</span>(lubridate)</a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;lubridate&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     date</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1"><span class="co"># Generating an epidemic with given parameters</span></a>
<a class="sourceLine" id="cb52-2" data-line-number="2">mGT &lt;-<span class="st"> </span><span class="kw">generation.time</span>(<span class="st">&quot;gamma&quot;</span>, <span class="kw">c</span>(<span class="dv">3</span>,<span class="fl">1.5</span>))</a>
<a class="sourceLine" id="cb52-3" data-line-number="3"><span class="kw">set.seed</span>(<span class="dv">5432</span>)  <span class="co"># always initialize when simulating!</span></a>
<a class="sourceLine" id="cb52-4" data-line-number="4">mEpid &lt;-<span class="st"> </span><span class="kw">sim.epid</span>(<span class="dt">epid.nb=</span><span class="dv">1</span>, <span class="dt">GT=</span>mGT, <span class="dt">epid.length=</span><span class="dv">30</span>, </a>
<a class="sourceLine" id="cb52-5" data-line-number="5">     <span class="dt">family=</span><span class="st">&quot;poisson&quot;</span>, <span class="dt">R0=</span><span class="fl">1.67</span>, <span class="dt">peak.value=</span><span class="dv">500</span>)</a>
<a class="sourceLine" id="cb52-6" data-line-number="6">mEpid &lt;-<span class="st"> </span>mEpid[,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb52-7" data-line-number="7"><span class="co"># Running estimations</span></a>
<a class="sourceLine" id="cb52-8" data-line-number="8">est &lt;-<span class="st"> </span><span class="kw">estimate.R</span>(<span class="dt">epid=</span>mEpid, <span class="dt">GT=</span>mGT, <span class="dt">methods=</span><span class="kw">c</span>(<span class="st">&quot;EG&quot;</span>,<span class="st">&quot;ML&quot;</span>,<span class="st">&quot;TD&quot;</span>), <span class="dt">begin=</span><span class="dv">1</span>, <span class="dt">end=</span><span class="dv">30</span>)</a></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<pre><code>## Warning in est.R0.TD(epid = c(1, 0, 1, 0, 1, 0, 2, 1, 2, 1, 7, 2, 3, 4, :
## Simulations may take several minutes.</code></pre>
<pre><code>## Warning in est.R0.TD(epid = c(1, 0, 1, 0, 1, 0, 2, 1, 2, 1, 7, 2, 3, 4, : Using
## initial incidence as initial number of cases.</code></pre>
<p>We modified the plotting function in <em><a href="https://CRAN.R-project.org/package=R0">R0</a></em> which
was calling <code>dev.new</code> too often. Use <code>plot2</code>.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb56-2" data-line-number="2"><span class="kw">plot2</span>(est)</a></code></pre></div>
<p><img src="r0_estimates_files/figure-html/lksim-1.png" width="672" /></p>
<p>The plotfit2 function is also useful. These fits
look identical but they are not.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb57-2" data-line-number="2"><span class="kw">plotfit2</span>(est)</a></code></pre></div>
<p><img src="r0_estimates_files/figure-html/lksim2-1.png" width="672" /></p>
</div>
<div id="real-data-examples" class="section level2">
<h2><span class="header-section-number">5.3</span> Real data examples</h2>
<p>Now we extract information from the time-series table and
obtain estimates of <span class="math inline">\(R_0\)</span> under exponential growth.</p>
<div id="hubei-province" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Hubei Province</h3>
<p>We are able to use exponential growth and time-dependent models
with this data, using generation time model from a
recent <a href="https://annals.org/aim/fullarticle/2762808/incubation-period-coronavirus-disease-2019-covid-19-from-publicly-reported">Annals of Internal Medicine</a> paper.</p>
<p>The incidence data probably need smoothing, and the time-dependent
model has unreasonable fluctuations.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1">dates =<span class="st"> </span>lubridate<span class="op">::</span><span class="kw">as_date</span>(<span class="kw">mdy</span>(<span class="kw">names</span>(mar19df)[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)]))</a>
<a class="sourceLine" id="cb58-2" data-line-number="2">hubdat =<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">get_series</span>(<span class="dt">province=</span><span class="st">&quot;Hubei&quot;</span>, <span class="dt">country=</span><span class="st">&quot;China&quot;</span>, </a>
<a class="sourceLine" id="cb58-3" data-line-number="3">    <span class="dt">dataset=</span>sars2pack<span class="op">::</span>mar19df))</a>
<a class="sourceLine" id="cb58-4" data-line-number="4"><span class="kw">names</span>(hubdat) =<span class="st"> </span>dates</a>
<a class="sourceLine" id="cb58-5" data-line-number="5">mGT &lt;-<span class="st"> </span><span class="kw">generation.time</span>(<span class="st">&quot;gamma&quot;</span>, <span class="kw">c</span>(<span class="fl">5.8</span>, <span class="fl">0.95</span>)) <span class="co"># from DOI 10.7326/M20-0504</span></a>
<a class="sourceLine" id="cb58-6" data-line-number="6">mGT &lt;-<span class="st"> </span><span class="kw">generation.time</span>(<span class="st">&quot;gamma&quot;</span>, <span class="kw">c</span>(<span class="fl">3.96</span>, <span class="fl">4.75</span>)) <span class="co"># from DOI 10.7326/M20-0504</span></a>
<a class="sourceLine" id="cb58-7" data-line-number="7">hubdat.filt =<span class="st"> </span><span class="kw">trim_leading_values</span>(<span class="kw">c</span>(hubdat[<span class="dv">1</span>], <span class="kw">diff</span>(hubdat)))</a>
<a class="sourceLine" id="cb58-8" data-line-number="8">est.EG &lt;-<span class="st"> </span><span class="kw">estimate.R</span>(<span class="dt">epid=</span>hubdat.filt, <span class="dt">GT=</span>mGT, </a>
<a class="sourceLine" id="cb58-9" data-line-number="9">    <span class="dt">methods=</span><span class="kw">c</span>(<span class="st">&quot;EG&quot;</span>, <span class="st">&quot;TD&quot;</span>), <span class="dt">begin=</span>1L, <span class="dt">end=</span><span class="kw">as.integer</span>(<span class="kw">length</span>(hubdat.filt)))</a></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<pre><code>## Warning in est.R0.TD(epid = c(`2020-01-22` = 444, `2020-01-23` = 0, `2020-01-24`
## = 105, : Simulations may take several minutes.</code></pre>
<pre><code>## Warning in est.R0.TD(epid = c(`2020-01-22` = 444, `2020-01-23` = 0, `2020-01-24`
## = 105, : Using initial incidence as initial number of cases.</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1">est.EG</a></code></pre></div>
<pre><code>## Reproduction number estimate using  Exponential Growth  method.
## R :  0.8190473[ 0.8164334 , 0.821658 ]
## 
## Reproduction number estimate using  Time-Dependent  method.
## 2.020789 0 3.0142 3.134995 3.32356 3.865543 1.596743 0 1.878637 2.079345 ...</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb64-2" data-line-number="2"><span class="kw">plot2</span>(est.EG)</a>
<a class="sourceLine" id="cb64-3" data-line-number="3"><span class="kw">plotfit2</span>(est.EG)</a></code></pre></div>
<p><img src="r0_estimates_files/figure-html/dohub-1.png" width="672" /></p>
</div>
<div id="italy" class="section level3">
<h3><span class="header-section-number">5.3.2</span> Italy</h3>
<p>For Italy, only the EG model seems to work, with the
Annals of Internal Medicine generation time model. It
fits the data reasonably well, but the data seems to include
a reporting gap.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" data-line-number="1">itdat =<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">get_series</span>(<span class="dt">province=</span><span class="st">&quot;&quot;</span>, <span class="dt">country=</span><span class="st">&quot;Italy&quot;</span>, </a>
<a class="sourceLine" id="cb65-2" data-line-number="2">    <span class="dt">dataset=</span>sars2pack<span class="op">::</span>mar19df))</a>
<a class="sourceLine" id="cb65-3" data-line-number="3"><span class="kw">names</span>(itdat) =<span class="st"> </span>dates</a>
<a class="sourceLine" id="cb65-4" data-line-number="4">itdat.filt =<span class="st"> </span><span class="kw">trim_leading_values</span>(<span class="kw">c</span>(itdat[<span class="dv">1</span>], <span class="kw">diff</span>(itdat)))</a>
<a class="sourceLine" id="cb65-5" data-line-number="5">est.EG &lt;-<span class="st"> </span><span class="kw">estimate.R</span>(<span class="dt">epid=</span>itdat.filt, <span class="dt">GT=</span>mGT, </a>
<a class="sourceLine" id="cb65-6" data-line-number="6">    <span class="dt">methods=</span><span class="kw">c</span>(<span class="st">&quot;EG&quot;</span>), <span class="dt">begin=</span>1L, <span class="dt">end=</span><span class="kw">as.integer</span>(<span class="kw">length</span>(itdat.filt)))</a></code></pre></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" data-line-number="1">est.EG</a></code></pre></div>
<pre><code>## Reproduction number estimate using  Exponential Growth  method.
## R :  1.968466[ 1.957161 , 1.979874 ]</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" data-line-number="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb69-2" data-line-number="2"><span class="kw">plot2</span>(est.EG, <span class="dt">main=</span><span class="st">&quot;Italy&quot;</span>)</a>
<a class="sourceLine" id="cb69-3" data-line-number="3"><span class="kw">plotfit2</span>(est.EG, <span class="dt">main=</span><span class="st">&quot;Italy&quot;</span>)</a></code></pre></div>
<p><img src="r0_estimates_files/figure-html/doit-1.png" width="672" /></p>
</div>
<div id="new-york-city" class="section level3">
<h3><span class="header-section-number">5.3.3</span> New York City</h3>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" data-line-number="1">nyt =<span class="st"> </span><span class="kw">nytimes_county_data</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb70-2" data-line-number="2"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">filter</span>(county<span class="op">==</span><span class="st">&#39;New York City&#39;</span> <span class="op">&amp;</span><span class="st"> </span>subset<span class="op">==</span><span class="st">&#39;confirmed&#39;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb70-3" data-line-number="3"><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(date)</a>
<a class="sourceLine" id="cb70-4" data-line-number="4">nytdat =<span class="st"> </span>nyt<span class="op">$</span>count</a>
<a class="sourceLine" id="cb70-5" data-line-number="5"><span class="co"># do we need to chop zeros off? Seems like not.</span></a>
<a class="sourceLine" id="cb70-6" data-line-number="6">nytdat.filt =<span class="st"> </span><span class="kw">c</span>(nytdat[<span class="dv">1</span>], <span class="kw">diff</span>(nytdat))</a>
<a class="sourceLine" id="cb70-7" data-line-number="7">est &lt;-<span class="st"> </span><span class="kw">estimate.R</span>(<span class="dt">epid=</span>nytdat.filt, <span class="dt">GT=</span>mGT, </a>
<a class="sourceLine" id="cb70-8" data-line-number="8">                  <span class="dt">methods=</span><span class="kw">c</span>(<span class="st">&quot;EG&quot;</span>,<span class="st">&quot;TD&quot;</span>,<span class="st">&quot;ML&quot;</span>), <span class="dt">begin=</span>1L, <span class="dt">end=</span><span class="kw">as.integer</span>(<span class="kw">length</span>(nytdat.filt)))</a></code></pre></div>
<p>We can also use the package <em><a href="https://CRAN.R-project.org/package=EpiEstim">EpiEstim</a></em> to perform time-dependent <span class="math inline">\(R_0\)</span> calculations.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" data-line-number="1"><span class="kw">library</span>(EpiEstim)</a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;EpiEstim&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:sars2pack&#39;:
## 
##     estimate_R</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" data-line-number="1">epiestim =<span class="st"> </span>EpiEstim<span class="op">::</span><span class="kw">estimate_R</span>(nytdat.filt, <span class="dt">method =</span> <span class="st">&quot;parametric_si&quot;</span>,</a>
<a class="sourceLine" id="cb74-2" data-line-number="2">                                <span class="dt">config =</span> EpiEstim<span class="op">::</span><span class="kw">make_config</span>(<span class="kw">list</span>(</a>
<a class="sourceLine" id="cb74-3" data-line-number="3">                                    <span class="dt">mean_si =</span> <span class="fl">3.96</span>, <span class="dt">std_si =</span> <span class="fl">4.75</span>)))</a></code></pre></div>
<pre><code>## Default config will estimate R on weekly sliding windows.
##     To change this change the t_start and t_end arguments.</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" data-line-number="1"><span class="kw">plot</span>(epiestim)</a></code></pre></div>
<p><img src="r0_estimates_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre><code>## TableGrob (3 x 1) &quot;arrange&quot;: 3 grobs
##       z     cells    name           grob
## incid 1 (1-1,1-1) arrange gtable[layout]
## R     2 (2-2,1-1) arrange gtable[layout]
## SI    3 (3-3,1-1) arrange gtable[layout]</code></pre>

</div>
</div>
</div>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-93043521-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-93043521-4');
</script>
            </section>

          </div>
        </div>
      </div>
<a href="use-cases.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="european-datasets.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/seandavi/COVID19Book/edit/master/r0_estimates.Rmd",
"text": "Edit"
},
"history": {
"link": "https://github.com/seandavi/COVID19Book/commits/master/r0_estimates.Rmd",
"text": null
},
"view": {
"link": "https://github.com/seandavi/COVID19Book/blob/master/r0_estimates.Rmd",
"text": null
},
"download": ["covid_19.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
